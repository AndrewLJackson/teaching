---
title       : Log-Log Regression
subtitle    : Allometric, and other scaling
author      : Andrew Jackson
job         : Associate Professor
framework   : io2012        # {io2012, html5slides, shower, dzslides, ...}
highlighter : highlight.js  # {highlight.js, prettify, highlight}
hitheme     : tomorrow      # 
widgets     : mathjax            # {mathjax, quiz, bootstrap}
mode        : selfcontained # {standalone, draft}
knit        : slidify::knit2slides
---

--- &vcenter

## Still just linear regression
But now with log transformed data on the x and y axes


```{r, echo = FALSE}
# set some global knitr build options, notably the default figure size
knitr::opts_chunk$set(collapse = TRUE, comment = "#-", 
                      fig.width = 5, fig.height = 5)

# load the viridis package for pretty and accessible colours especially for those with 
# colour blindness. You will need to install this if you dont have it already using
# install.packages("viridis")
library(viridis)

# Here I create a palette of 8 colours from the viridis spectrum. I can then access these colours
# within plotting commands by e.g. plot(0,0, col = 1), or plot(0,0, col = 4) or plot(0,0, col = 8).
# This palette is also useful as it will print clearly in greyscale without any extra effort.
# see vignette for viridis for more details.
palette(viridis(8))

```

```{r, fig.width = 7, fig.height = 5, echo = FALSE}

# read in the data
mydata <- read.csv("assets/data/brain-data.csv", header = T )

# Im going to convert to kilograms so we get some numbers less 
# than 1 for this example
mydata$brain <- mydata$brain / 1000
mydata$body <- mydata$body / 1000

# plot the log transformed data as a scatter plot
plot(log10(mydata$body), log10(mydata$brain),
     pch = 19, las = 1, bty = "L",
     xlab = expression(log[10](body~mass~kg)),
     ylab = expression(log[10](brain~mass~kg)),
     cex.lab = 1.3,
     cex.axis = 1.2,
     col = 4,
     mgp = c(2.5, 1, 0))
abline(glm(log10(brain)~log10(body), data = mydata), col = 1, lwd = 2 )



```


--- .class #id 

## Focus on length-mass relationships

- How does the mass of an organism scale with its length?
- Scaling is related to interesting biological and ecological processes
   - Metabolic costs
   - Transport of molecules over membranes
   - Predation or fishing / harvesting
   - Diet
   - Ecological scaling laws (abundance and biomass)

--- .class #id 

## Scaling of simple shapes

- How does a cube scale with its length?
- $Mass = Density * Volume$
- Assume density stays the same no matter what size, so $Mass \propto Volume$
- $Volume = L_1 * L_2 * L_3$
- $Volume = a * L ^ b$
- So if the cube stays the same shape (i.e. it remains a cube)
   - How does mass change if length is doubled?
   - $Volume = 2L_1 * 2L_2 * 2L_3 = 2 * L ^ 3$
- Isometric scaling is when the object stays the same shape as it grows or shrinks

--- &two-cols w1:58% w2:38%
## Spherical cows

*** {name: left}
> - How does mass of a sphere change with length?
> - $Volume = \frac{4}{3} * \pi * r ^ 3$
> - $Volume = \frac{4}{3} * \pi * \frac{L^3}{2^3} = \frac{4}{3*9} * \pi * L^3$
> - Again, $Volume$, and hence $Mass$ changes with $Length^3$
> - So, generally we have...
> - $Volume = (some ~ number) * L^3$
> - $Volume = a * L ^ b$
> - Where for isometric scaling of $Volume$ (or $Mass$) with $Length$, $b = 3$

*** {name: right}
<img src="assets/img/SphericalCow2.gif" href="https://commons.wikimedia.org/wiki/File:SphericalCow2.gif#/media/File:SphericalCow2.gif">

--- .class #id 

## A general equation for scaling of Mass to Length
> - $Mass = a * Length ^ b$
> - Take the Log of both sides (doesnt matter what logarithmic base)
> - $\log(M) = \log(a * L ^ 3)$
> - $\log(M) = \log(a) + \log(L^b)$
> - $\log(M) = \log(a) + b * \log(L)$
> - $Y = b_0 + b_1 * X$
> - where... $\log(a) = b_0$
> - so... $a = e^{b_0}$
> - and... $b_1 = b$ and is simply the power in the allometric equation


--- .class #id 

##  Mass - Length scaling in Finish Fish
```{r, fig.width = 9, fig.height = 6, echo = FALSE}

library(rrcov, verbose=F, quietly=T)
data("fish")

with(fish[complete.cases(fish) & fish$Weight>0,],{

# plot the log transformed data as a scatter plot
plot(log10(Length1), log10(Weight),
     pch = 19, las = 1, bty = "L",
     xlab = expression(log[10](Length~cm)),
     ylab = expression(log[10](Mass~g)),
     cex.lab = 1.3,
     cex.axis = 1.2,
     col = Species,
     mgp = c(2.5, 1, 0))
  
  
m1 <- glm(log10(Weight)~log10(Length1), data = fish[complete.cases(fish) & fish$Weight>0,])

# add the glm line to the plot
abline(m1, col = 1 )

# print the equation on the plot
m1_coef <- round(coef(m1), 2) # extract coefficients 
text(0.9, 3,
     bquote( log10(M) == .(m1_coef[1]) + .(m1_coef[2]) * (log10(L)) ),
     cex = 1.6, adj = c(0,0))
text(0.9, 2.5,
     bquote( M == .(round(10^m1_coef[1], 3)) * (L) ^ .(m1_coef[2]) ), 
     cex = 1.6, adj = c(0,0))

}) # end with() statement


```


--- &two-cols w1:18% w2:78%

## Two Column Layout   

This slide **should** have two columns of variable width 

*** {name: left}

- point 1
- point 2
- point 3

*** {name: right}

- point 4
- point 5
- point 6


